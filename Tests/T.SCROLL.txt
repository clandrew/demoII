********************************
* OBJ $6000
 ORG $6000
*
TXTCLR EQU $C050
TXTSET EQU $C051
MIXCLR EQU $C052
LORES EQU $C056
CLRGR EQU $F832
KYBD EQU $C000
TBUFCLR EQU $FC58
CHIRP EQU $C030
WAIT EQU $FCA8
*
VSCROLL EQU $D7
IMGBASE0 EQU $EB
IMGBASE1 EQU $EC
*
 LDA #$00
 STA TXTCLR
 STA MIXCLR
 STA LORES
*
 JSR CLRGR
********************************
*
 LDA #$00
 STA VSCROLL
*
 LDA #<TUNNEL
 STA IMGBASE0
 LDA #>TUNNEL
 STA IMGBASE1
 JSR FILLIMG

********************************
*
LOOP NOP
 LDA KYBD
 PHA
 AND #$7F
 STA $C010
 PLA
 CMP #$8A
 BNE SCRLDNCHK
 JSR SCROLLDOWN
 JMP LOOP
SCRLDNCHK NOP
 CMP #$8B
 BNE SCRLUPCHK
 JSR SCROLLUP
 JMP LOOP
SCRLUPCHK
 CMP #$80
 BCC LOOP
 LDA #$00
 STA TXTSET
 JSR TBUFCLR
 RTS ; END MAINLINE
*
********************************
*
SCROLLDOWN NOP
 LDA #<TUNNEL
 STA IMGBASE0
 LDA #>TUNNEL
 STA IMGBASE1
 INC VSCROLL
 JSR FILLIMG ; REPAINT
 RTS
*
********************************
*
SCROLLUP NOP
 LDA #<TUNNEL
 STA IMGBASE0
 LDA #>TUNNEL
 STA IMGBASE1
 DEC VSCROLL
 JSR FILLIMG ; REPAINT
 RTS
*
********************************
* INCIMGBASE
* INCREMENTS IMGBASE BY #$28.
INCIMGBASE LDA IMGBASE0
 CLC
 ADC #$28
 STA IMGBASE0
 BCC NOCARRY
 INC IMGBASE1
NOCARRY RTS
********************************
* FILLIMG
* REQUIRES ADDRESS OF IMAGE IN EB-EC.
* CLOBBERS EB-EC.
*
FILLIMG LDY #$00
*
* APPLY SCROLLING AMOUNT.
 LDX VSCROLL
APPLYSCROLL CPX #$00
 BEQ DONESCROLL
 JSR INCIMGBASE
 DEX
 JMP APPLYSCROLL
DONESCROLL
*
ROWPAIR NOP
 LDA LORESR0,Y
 STA $E9
 LDA LORESR0+1,Y
 STA $E8
*
 LDX #$0
*
IMGBYTE TYA
 PHA
 TXA
 TAY
 LDA ($EB),Y
 STA ($E8),Y
 PLA
 TAY
 INX
 CPX #$28
 BNE IMGBYTE
*
 JSR INCIMGBASE
 INY
 INY
 CPY #$30
 BNE ROWPAIR
 RTS
*
TUNNEL HEX 22222222222222222222222222222222
 HEX 22222222222222222222222222222222
 HEX 22222222222222222222222222222222
 HEX 22222222222222222222222222222222
 HEX 22222222222222222222222222222222
 HEX 222222222222D2222222222222222222
 HEX 2222D222222222222222222222222222
 HEX 22222222222222222222222222222222
 HEX 22222222222222222222222222222222
 HEX 22222222222222222222222D22222222
 HEX 22222222222222222222222222222222
 HEX 22222222222222222222222222222222
 HEX 22222222222222222222222222222222
 HEX 22D22222222222222222222222222222
 HEX 22222222222222222222222222222222
 HEX 22222222222222222222222222222222
 HEX 2D22222222222222222222222D222222
 HEX 22222222222222222222222222222222
 HEX 22222222222222222222222222222222
 HEX 22222222222222222222222222222222
 HEX 2222D222222222222222222222222222
 HEX 22222222222222222222222222222222
 HEX 22222222222D22222222222222222222
 HEX 22222222222222222222222222222222
 HEX 22222222222222222222222222222222
 HEX 22222222222222222222222222222222
 HEX 22222222222202020202020222222222
 HEX 22222222222222222222222222222222
 HEX 22222222222222222222222222220000
 HEX 00000000222222222222222222222222
 HEX 00000000222222222222222222222222
 HEX 22222222222200000000000022222222
 HEX 22222222222222220000000022222222
 HEX 22222222222222222222222222220000
 HEX 00000000220202020222222200000000
 HEX 00000000222222222222222222222222
 HEX 22222222222200000000000022000000
 HEX 00222222000000000000000022000000
 HEX 22222222220202020202022222220000
 HEX 00000000000000000022222200000000
 HEX 00000000020000002200000000000000
 HEX 00000000000000000000000000000000
 HEX 00222222000000000000000000000000
 HEX 00000000000000000000000000000000
 HEX 00000000000000000000000000000000
 HEX 00000000000000000000000000000000
 HEX 00000000000000000000000000000000
 HEX 00000000000000008000800080008000
 HEX 80008000800080008000800080008000
 HEX 80008000800080008000800080008000
 HEX 08000800080008000800080008000800
 HEX 08000800080008000800080008000800
 HEX 08000800080008008888888888880088
 HEX 88888888888800888888888888880088
 HEX 88888888888800888888888888880088
 HEX 08080808080800080808080808080008
 HEX 08080808080800080808080808080008
 HEX 08080808080800088800888888888888
 HEX 88008888888888888800888888888888
 HEX 88008888888888888800888888888888
 HEX 88008888888888888800888888888888
 HEX 88008888888888888800888888888888
 HEX 88008888888888888080808000808080
 HEX 80808080008080808080808000808080
 HEX 80808080008080808080808000808080
 HEX 88888888008888888888888800888888
 HEX 88888888008888888888888800888888
 HEX 88888888008888880909090800090909
 HEX 09090908000909090909090800090909
 HEX 09090908000808080808080800080808
 HEX 80808080808080808080808080808080
 HEX 80808080808080808080808080808080
 HEX 80000000000000000000202020202020
 HEX 20202020202020202020202020202020
 HEX 20202020202020200888888080808080
 HEX 02020000000000000000000000000000
 HEX 00000000000000000000000000000000
 HEX 00080808080808080000000000000000
 HEX 00000000000000000000000000000000
 HEX 00000000000000000000999998880088
 HEX 00000000000000000000000000000000
 HEX 00000000000000000000000000000000
 HEX 00009000808080800000000000000000
 HEX 00000000000000000000000000000000
 HEX 00000000000000000000090008080808
 HEX 20202020202020202060606020202020
 HEX 20202020000202020222222222222020
 HEX 20000099888888882222222262622626
 HEX 26222222222222222222222222222222
 HEX 22202020020202022222200808000808
 HEX 22226226222222222222222222222222
 HEX 22222222222222222222222222222222
 HEX 20606262620080806226222222222222
 HEX 22222222222222222222222222222222
 HEX 22222222226262060680202020200808
 HEX 66222222222222222222222222626262
 HEX 62626262626262626262626206808008
 HEX 08882222222200086666666666666666
 HEX 66666666666666868666666666666686
 HEX 88866666008888808088222222220000
 HEX 66666666868888888666666666868888
 HEX 88888666666688888888886600880808
 HEX 88882222220088086666668888888888
 HEX 88886666668888988898886666668888
 HEX 88888866008800008808020202008080
 HEX 66666698989998989998666666999999
 HEX 99999966666698989999980600000050
 HEX 50555555550008086666669999999999
 HEX 99996666669999D8D899996666669979
 HEX 79797777555555555555555555008800
 HEX 6666669999999999999966060609E90D
 HEX 0DE77777707057575757777777777775
 HEX 75555555550000006606067979797977
 HEX 7777777775DEEE0000EE5E7D77777775
 HEX 75555555577777777777777575008888
 HEX 5050575777777777777777777777EE00
 HEX 7000EE55575757777777777775757555
 HEX 57777777770080805555555555555555
 HEX 57577777777700707700777775755555
 HEX 57777777777777777777770700000808
 HEX 55555555555555555555555757777077
 HEX 77707077777777757555555757777777
 HEX 77777700888800885555555555555555
 HEX 55555555555555575777777777777777
 HEX 77777775755555575777770000000000
*
LORESR0 HEX 0400
 HEX 0480
 HEX 0500
 HEX 0580
 HEX 0600
 HEX 0680
 HEX 0700
 HEX 0780
 HEX 0428
 HEX 04A8
 HEX 0528
 HEX 05A8
 HEX 0628
 HEX 06A8
 HEX 0728
 HEX 07A8
 HEX 0450
 HEX 04D0
 HEX 0550
 HEX 05D0
 HEX 0650
 HEX 06D0
 HEX 0750
 HEX 07D0
